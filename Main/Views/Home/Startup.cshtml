@inherits Crm.Library.Modularization.CrmViewUserControl
@using Crm.Library.Extensions
@using Crm.Library.Globalization.Extensions
@using Crm.Library.Modularization.Extensions

<div class="container">
	<div id="startup-details" class="card col-xs-12 col-sm-8 col-sm-offset-2">
		<div class="listview">
			<!-- ko if: errorMessage -->
			<div class="m-t-25 alert alert-danger alert-dismissible" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="@(Html.Localize("Close"))"><span aria-hidden="true">&times;</span></button>
				<p>@(Html.Localize("Error_InternalServerError"))</p>
				<p><pre class="pre-scrollable" data-bind="html: Helper.String.replaceLineBreaks(errorMessage())"></pre></p>
				<p>
					<a class="btn btn-default" data-bind="click: retry">
						@(Html.Localize("Retry"))
					</a>
					<a class="btn btn-default" href="@(Url.Content("~/Account/Login"))">
						@(Html.Localize("BackToLogin"))
					</a>
				</p>
			</div>
			<!-- /ko -->
			<div class="lv-body m-t-25" data-bind="foreach: steps">
				<div class="lv-item">
					<div class="lv-title m-b-5">
						<span data-bind="text: description"></span>
						<!-- ko if: !!$data.completedItems && !!$data.totalItems && status() == 'loading' -->
						<small class="pull-right"><span data-bind="text: completedItems"></span> / <span data-bind="	text: totalItems"></span></small>
						<!-- /ko -->
					</div>
					<div class="progress progress-striped active">
						<div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0" data-bind="css: { 'progress-bar-success': status() === 'success', 'progress-bar-danger': status() === 'error' }, attr: { 'aria-valuenow': status() === 'success' || status() === 'error' ? 100 : !!$data.completion ? completion() : 0 }, style: { width: (status() === 'success' || status() === 'error' ? 100 : !!$data.completion ? completion() : 0) + '%' }">
						</div>
					</div>
				</div>
				<!-- ko if: !!$data.details && !!details() -->
				<div class="lv-item">
					<div class="lv-title m-b-5">
						<span data-bind="text: details"></span>
						<!-- ko if: !!$data.subCompletedItems && !!$data.subTotalItems && status() == 'loading' -->
						<small class="pull-right"><span data-bind="text: subCompletedItems"></span> / <span data-bind="text: subTotalItems"></span></small>
						<!-- /ko -->
					</div>
						<div class="progress progress-striped active">
							<!-- ko if: !!$data.detailsCompletion && !!detailsCompletion() -->
							<div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0" data-bind="attr: { 'aria-valuenow': detailsCompletion }, style: { width: detailsCompletion() + '%' }">
							</div>
							<!-- /ko -->
						</div>
				</div>
				<!-- /ko -->
			</div>
			<div class="row text-center p-b-20">
				<a class="btn btn-link btn-lg f-13 waves-effect m-t-10 waves-button" href="#" data-bind="click: cancel, enable: cancellable">
					@(Html.Localize("Cancel"))
				</a>
			</div>
		</div>
	</div>
</div>

@Html.PluginRenderActions("Startup")
@(Html.HiddenTranslation("SynchronizationNotCompleteWarning"))
@(Html.HiddenTranslation("DataSynchronizationToServer"))
@(Html.HiddenTranslation("SynchronizationNotCompleteWarning"))
@(Html.HiddenTranslation("DataSynchronizationToServer"))
@(Html.HiddenTranslation("OnlineStatus"))
@(Html.HiddenTranslation("ApplicationFiles"))
@(Html.HiddenTranslation("ServerConnection"))
@(Html.HiddenTranslation("InitDatabase"))
@(Html.HiddenTranslation("InitializePermissions"))
@(Html.HiddenTranslation("LoadSettings"))
@(Html.HiddenTranslation("LoadTranslations"))
@(Html.HiddenTranslation("LoadLicenseData"))
@(Html.HiddenTranslation("DataSynchronizationToServer"))
@(Html.HiddenTranslation("DataSynchronizationFromServer"))
@(Html.HiddenTranslation("DatabaseMigration"))
@(Html.HiddenTranslation("RegisterNumberingService"))
@(Html.HiddenTranslation("InitCurrentUser"))
@(Html.HiddenTranslation("InitializeTaskTopMenuViewModel"))
@(Html.HiddenTranslation("InitRules"))
@(Html.HiddenTranslation("MainMenu"))
